"use strict";function t(t,e,r,a,h){n(t,e,r||0,a||t.length-1,h||i)}function n(t,i,r,a,h){for(;a>r;){if(a-r>600){var o=a-r+1,s=i-r+1,l=Math.log(o),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(o-u)/o)*(s-o/2<0?-1:1);n(t,i,Math.max(r,Math.floor(i-s*u/o+c)),Math.min(a,Math.floor(i+(o-s)*u/o+c)),h)}var m=t[i],f=r,x=a;for(e(t,r,i),h(t[a],m)>0&&e(t,r,a);f<x;){for(e(t,f,x),f++,x--;h(t[f],m)<0;)f++;for(;h(t[x],m)>0;)x--}0===h(t[r],m)?e(t,r,x):e(t,++x,a),x<=i&&(r=x+1),i<=x&&(a=x-1)}}function e(t,n,e){var i=t[n];t[n]=t[e],t[e]=i}function i(t,n){return t<n?-1:t>n?1:0}Object.defineProperty(exports,"__esModule",{value:!0});class r{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(t){let n=this.data;const e=[];if(!p(t,n))return e;const i=this.toBBox,r=[];for(;n;){for(let a=0;a<n.children.length;a++){const h=n.children[a],o=n.leaf?i(h):h;p(t,o)&&(n.leaf?e.push(h):x(t,o)?this._all(h,e):r.push(h))}n=r.pop()}return e}collides(t){let n=this.data;if(!p(t,n))return!1;const e=[];for(;n;){for(let i=0;i<n.children.length;i++){const r=n.children[i],a=n.leaf?this.toBBox(r):r;if(p(t,a)){if(n.leaf||x(t,a))return!0;e.push(r)}}n=e.pop()}return!1}load(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(let n=0;n<t.length;n++)this.insert(t[n]);return this}let n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const t=this.data;this.data=n,n=t}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=d([]),this}remove(t,n){if(!t)return this;let e=this.data;const i=this.toBBox(t),r=[],h=[];let o,s,l;for(;e||r.length;){if(e||(e=r.pop(),s=r[r.length-1],o=h.pop(),l=!0),e.leaf){const i=a(t,e.children,n);if(-1!==i)return e.children.splice(i,1),r.push(e),this._condense(r),this}l||e.leaf||!x(e,i)?s?(o++,e=s.children[o],l=!1):e=null:(r.push(e),h.push(o),o=0,s=e,e=e.children[0])}return this}toBBox(t){return t}compareMinX(t,n){return t.minX-n.minX}compareMinY(t,n){return t.minY-n.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,n){const e=[];for(;t;)t.leaf?n.push(...t.children):e.push(...t.children),t=e.pop();return n}_build(t,n,e,i){const r=e-n+1;let a,o=this._maxEntries;if(r<=o)return a=d(t.slice(n,e+1)),h(a,this.toBBox),a;i||(i=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,i-1))),a=d([]),a.leaf=!1,a.height=i;const s=Math.ceil(r/o),l=s*Math.ceil(Math.sqrt(o));g(t,n,e,l,this.compareMinX);for(let r=n;r<=e;r+=l){const n=Math.min(r+l-1,e);g(t,r,n,s,this.compareMinY);for(let e=r;e<=n;e+=s){const r=Math.min(e+s-1,n);a.children.push(this._build(t,e,r,i-1))}}return h(a,this.toBBox),a}_chooseSubtree(t,n,e,i){for(;i.push(n),!n.leaf&&i.length-1!==e;){let e,i=1/0,h=1/0;for(let o=0;o<n.children.length;o++){const s=n.children[o],l=c(s),u=(r=t,a=s,(Math.max(a.maxX,r.maxX)-Math.min(a.minX,r.minX))*(Math.max(a.maxY,r.maxY)-Math.min(a.minY,r.minY))-l);u<h?(h=u,i=l<i?l:i,e=s):u===h&&l<i&&(i=l,e=s)}n=e||n.children[0]}var r,a;return n}_insert(t,n,e){const i=e?t:this.toBBox(t),r=[],a=this._chooseSubtree(i,this.data,n,r);for(a.children.push(t),s(a,i);n>=0&&r[n].children.length>this._maxEntries;)this._split(r,n),n--;this._adjustParentBBoxes(i,r,n)}_split(t,n){const e=t[n],i=e.children.length,r=this._minEntries;this._chooseSplitAxis(e,r,i);const a=this._chooseSplitIndex(e,r,i),o=d(e.children.splice(a,e.children.length-a));o.height=e.height,o.leaf=e.leaf,h(e,this.toBBox),h(o,this.toBBox),n?t[n-1].children.push(o):this._splitRoot(e,o)}_splitRoot(t,n){this.data=d([t,n]),this.data.height=t.height+1,this.data.leaf=!1,h(this.data,this.toBBox)}_chooseSplitIndex(t,n,e){let i,r=1/0,a=1/0;for(let h=n;h<=e-n;h++){const n=o(t,0,h,this.toBBox),s=o(t,h,e,this.toBBox),l=f(n,s),u=c(n)+c(s);l<r?(r=l,i=h,a=u<a?u:a):l===r&&u<a&&(a=u,i=h)}return i||e-n}_chooseSplitAxis(t,n,e){const i=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:u;this._allDistMargin(t,n,e,i)<this._allDistMargin(t,n,e,r)&&t.children.sort(i)}_allDistMargin(t,n,e,i){t.children.sort(i);const r=this.toBBox,a=o(t,0,n,r),h=o(t,e-n,e,r);let l=m(a)+m(h);for(let i=n;i<e-n;i++){const n=t.children[i];s(a,t.leaf?r(n):n),l+=m(a)}for(let i=e-n-1;i>=n;i--){const n=t.children[i];s(h,t.leaf?r(n):n),l+=m(h)}return l}_adjustParentBBoxes(t,n,e){for(let i=e;i>=0;i--)s(n[i],t)}_condense(t){for(let n,e=t.length-1;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children,n.splice(n.indexOf(t[e]),1)):this.clear():h(t[e],this.toBBox)}}function a(t,n,e){if(!e)return n.indexOf(t);for(let i=0;i<n.length;i++)if(e(t,n[i]))return i;return-1}function h(t,n){o(t,0,t.children.length,n,t)}function o(t,n,e,i,r){r||(r=d(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let a=n;a<e;a++){const n=t.children[a];s(r,t.leaf?i(n):n)}return r}function s(t,n){return t.minX=Math.min(t.minX,n.minX),t.minY=Math.min(t.minY,n.minY),t.maxX=Math.max(t.maxX,n.maxX),t.maxY=Math.max(t.maxY,n.maxY),t}function l(t,n){return t.minX-n.minX}function u(t,n){return t.minY-n.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function m(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,n){const e=Math.max(t.minX,n.minX),i=Math.max(t.minY,n.minY),r=Math.min(t.maxX,n.maxX),a=Math.min(t.maxY,n.maxY);return Math.max(0,r-e)*Math.max(0,a-i)}function x(t,n){return t.minX<=n.minX&&t.minY<=n.minY&&n.maxX<=t.maxX&&n.maxY<=t.maxY}function p(t,n){return n.minX<=t.maxX&&n.minY<=t.maxY&&n.maxX>=t.minX&&n.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(n,e,i,r,a){const h=[e,i];for(;h.length;){if((i=h.pop())-(e=h.pop())<=r)continue;const o=e+Math.ceil((i-e)/r/2)*r;t(n,o,e,i,a),h.push(e,o,o,i)}}class M{constructor(t=[],n=v){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:e}=this,i=n[t];for(;t>0;){const r=t-1>>1,a=n[r];if(e(i,a)>=0)break;n[t]=a,t=r}n[t]=i}_down(t){const{data:n,compare:e}=this,i=this.length>>1,r=n[t];for(;t<i;){let i=1+(t<<1),a=n[i];const h=i+1;if(h<this.length&&e(n[h],a)<0&&(i=h,a=n[h]),e(a,r)>=0)break;n[t]=a,t=i}n[t]=r}}function v(t,n){return t<n?-1:t>n?1:0}function X(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Y={exports:{}},_=function(t,n,e,i){var r=t[0],a=t[1],h=!1;void 0===e&&(e=0),void 0===i&&(i=n.length);for(var o=(i-e)/2,s=0,l=o-1;s<o;l=s++){var u=n[e+2*s+0],c=n[e+2*s+1],m=n[e+2*l+0],f=n[e+2*l+1];c>a!=f>a&&r<(m-u)*(a-c)/(f-c)+u&&(h=!h)}return h},B=function(t,n,e,i){var r=t[0],a=t[1],h=!1;void 0===e&&(e=0),void 0===i&&(i=n.length);for(var o=i-e,s=0,l=o-1;s<o;l=s++){var u=n[s+e][0],c=n[s+e][1],m=n[l+e][0],f=n[l+e][1];c>a!=f>a&&r<(m-u)*(a-c)/(f-c)+u&&(h=!h)}return h};Y.exports=function(t,n,e,i){return n.length>0&&Array.isArray(n[0])?B(t,n,e,i):_(t,n,e,i)},Y.exports.nested=B,Y.exports.flat=_;var b=X(Y.exports);const w=11102230246251565e-32,S=134217729,E=(3+8*w)*w;function O(t,n,e,i,r){let a,h,o,s,l=n[0],u=i[0],c=0,m=0;u>l==u>-l?(a=l,l=n[++c]):(a=u,u=i[++m]);let f=0;if(c<t&&m<e)for(u>l==u>-l?(h=l+a,o=a-(h-l),l=n[++c]):(h=u+a,o=a-(h-u),u=i[++m]),a=h,0!==o&&(r[f++]=o);c<t&&m<e;)u>l==u>-l?(h=a+l,s=h-a,o=a-(h-s)+(l-s),l=n[++c]):(h=a+u,s=h-a,o=a-(h-s)+(u-s),u=i[++m]),a=h,0!==o&&(r[f++]=o);for(;c<t;)h=a+l,s=h-a,o=a-(h-s)+(l-s),l=n[++c],a=h,0!==o&&(r[f++]=o);for(;m<e;)h=a+u,s=h-a,o=a-(h-s)+(u-s),u=i[++m],a=h,0!==o&&(r[f++]=o);return 0===a&&0!==f||(r[f++]=a),f}function y(t){return new Float64Array(t)}const A=33306690738754716e-32,j=22204460492503146e-32,k=11093356479670487e-47,P=y(4),D=y(8),R=y(12),q=y(16),I=y(4),J=(t,n,e)=>{n=Math.max(0,void 0===n?2:n),e=e||0;var i=function(t){for(var n=t[0],e=t[0],i=t[0],r=t[0],a=0;a<t.length;a++){var h=t[a];h[0]<n[0]&&(n=h),h[0]>i[0]&&(i=h),h[1]<e[1]&&(e=h),h[1]>r[1]&&(r=h)}var o=[n,e,i,r],s=o.slice();for(a=0;a<t.length;a++)b(t[a],o)||s.push(t[a]);return function(t){t.sort(V);for(var n=[],e=0;e<t.length;e++){for(;n.length>=2&&H(n[n.length-2],n[n.length-1],t[e])<=0;)n.pop();n.push(t[e])}for(var i=[],r=t.length-1;r>=0;r--){for(;i.length>=2&&H(i[i.length-2],i[i.length-1],t[r])<=0;)i.pop();i.push(t[r])}return i.pop(),n.pop(),n.concat(i)}(s)}(t),a=new r(16);a.toBBox=function(t){return{minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]}},a.compareMinX=function(t,n){return t[0]-n[0]},a.compareMinY=function(t,n){return t[1]-n[1]},a.load(t);for(var h,o=[],s=0;s<i.length;s++){var l=i[s];a.remove(l),h=L(l,h),o.push(h)}var u=new r(16);for(s=0;s<o.length;s++)u.insert(K(o[s]));for(var c=n*n,m=e*e;o.length;){var f=o.shift(),x=f.p,p=f.next.p,d=Q(x,p);if(!(d<m)){var g=d/c;(l=N(a,f.prev.p,x,p,f.next.next.p,g,u))&&Math.min(Q(l,x),Q(l,p))<=g&&(o.push(f),o.push(L(l,f)),a.remove(l),u.remove(f),u.insert(K(f)),u.insert(K(f.next)))}}f=h;var M=[];do{M.push(f.p),f=f.next}while(f!==h);return M.push(f.p),M};function N(t,n,e,i,r,a,h){for(var o=new M([],F),s=t.data;s;){for(var l=0;l<s.children.length;l++){var u=s.children[l],c=s.leaf?T(u,e,i):z(e,i,u);c>a||o.push({node:u,dist:c})}for(;o.length&&!o.peek().node.children;){var m=o.pop(),f=m.node,x=T(f,n,e),p=T(f,i,r);if(m.dist<x&&m.dist<p&&G(e,f,h)&&G(i,f,h))return f}(s=o.pop())&&(s=s.node)}return null}function F(t,n){return t.dist-n.dist}function z(t,n,e){if(C(t,e)||C(n,e))return 0;var i=U(t[0],t[1],n[0],n[1],e.minX,e.minY,e.maxX,e.minY);if(0===i)return 0;var r=U(t[0],t[1],n[0],n[1],e.minX,e.minY,e.minX,e.maxY);if(0===r)return 0;var a=U(t[0],t[1],n[0],n[1],e.maxX,e.minY,e.maxX,e.maxY);if(0===a)return 0;var h=U(t[0],t[1],n[0],n[1],e.minX,e.maxY,e.maxX,e.maxY);return 0===h?0:Math.min(i,r,a,h)}function C(t,n){return t[0]>=n.minX&&t[0]<=n.maxX&&t[1]>=n.minY&&t[1]<=n.maxY}function G(t,n,e){for(var i,r,a,h,o=Math.min(t[0],n[0]),s=Math.min(t[1],n[1]),l=Math.max(t[0],n[0]),u=Math.max(t[1],n[1]),c=e.search({minX:o,minY:s,maxX:l,maxY:u}),m=0;m<c.length;m++)if(i=c[m].p,r=c[m].next.p,a=t,i!==(h=n)&&r!==a&&H(i,r,a)>0!=H(i,r,h)>0&&H(a,h,i)>0!=H(a,h,r)>0)return!1;return!0}function H(t,n,e){return function(t,n,e,i,r,a){const h=(n-a)*(e-r),o=(t-r)*(i-a),s=h-o,l=Math.abs(h+o);return Math.abs(s)>=A*l?s:-function(t,n,e,i,r,a,h){let o,s,l,u,c,m,f,x,p,d,g,M,v,X,Y,_,B,b;const w=t-r,y=e-r,A=n-a,J=i-a;X=w*J,m=S*w,f=m-(m-w),x=w-f,m=S*J,p=m-(m-J),d=J-p,Y=x*d-(X-f*p-x*p-f*d),_=A*y,m=S*A,f=m-(m-A),x=A-f,m=S*y,p=m-(m-y),d=y-p,B=x*d-(_-f*p-x*p-f*d),g=Y-B,c=Y-g,P[0]=Y-(g+c)+(c-B),M=X+g,c=M-X,v=X-(M-c)+(g-c),g=v-_,c=v-g,P[1]=v-(g+c)+(c-_),b=M+g,c=b-M,P[2]=M-(b-c)+(g-c),P[3]=b;let N=function(t,n){let e=n[0];for(let t=1;t<4;t++)e+=n[t];return e}(0,P),F=j*h;if(N>=F||-N>=F)return N;if(c=t-w,o=t-(w+c)+(c-r),c=e-y,l=e-(y+c)+(c-r),c=n-A,s=n-(A+c)+(c-a),c=i-J,u=i-(J+c)+(c-a),0===o&&0===s&&0===l&&0===u)return N;if(F=k*h+E*Math.abs(N),N+=w*u+J*o-(A*l+y*s),N>=F||-N>=F)return N;X=o*J,m=S*o,f=m-(m-o),x=o-f,m=S*J,p=m-(m-J),d=J-p,Y=x*d-(X-f*p-x*p-f*d),_=s*y,m=S*s,f=m-(m-s),x=s-f,m=S*y,p=m-(m-y),d=y-p,B=x*d-(_-f*p-x*p-f*d),g=Y-B,c=Y-g,I[0]=Y-(g+c)+(c-B),M=X+g,c=M-X,v=X-(M-c)+(g-c),g=v-_,c=v-g,I[1]=v-(g+c)+(c-_),b=M+g,c=b-M,I[2]=M-(b-c)+(g-c),I[3]=b;const z=O(4,P,4,I,D);X=w*u,m=S*w,f=m-(m-w),x=w-f,m=S*u,p=m-(m-u),d=u-p,Y=x*d-(X-f*p-x*p-f*d),_=A*l,m=S*A,f=m-(m-A),x=A-f,m=S*l,p=m-(m-l),d=l-p,B=x*d-(_-f*p-x*p-f*d),g=Y-B,c=Y-g,I[0]=Y-(g+c)+(c-B),M=X+g,c=M-X,v=X-(M-c)+(g-c),g=v-_,c=v-g,I[1]=v-(g+c)+(c-_),b=M+g,c=b-M,I[2]=M-(b-c)+(g-c),I[3]=b;const C=O(z,D,4,I,R);X=o*u,m=S*o,f=m-(m-o),x=o-f,m=S*u,p=m-(m-u),d=u-p,Y=x*d-(X-f*p-x*p-f*d),_=s*l,m=S*s,f=m-(m-s),x=s-f,m=S*l,p=m-(m-l),d=l-p,B=x*d-(_-f*p-x*p-f*d),g=Y-B,c=Y-g,I[0]=Y-(g+c)+(c-B),M=X+g,c=M-X,v=X-(M-c)+(g-c),g=v-_,c=v-g,I[1]=v-(g+c)+(c-_),b=M+g,c=b-M,I[2]=M-(b-c)+(g-c),I[3]=b;const G=O(C,R,4,I,q);return q[G-1]}(t,n,e,i,r,a,l)}(t[0],t[1],n[0],n[1],e[0],e[1])}function K(t){var n=t.p,e=t.next.p;return t.minX=Math.min(n[0],e[0]),t.minY=Math.min(n[1],e[1]),t.maxX=Math.max(n[0],e[0]),t.maxY=Math.max(n[1],e[1]),t}function L(t,n){var e={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return n?(e.next=n.next,e.prev=n,n.next.prev=e,n.next=e):(e.prev=e,e.next=e),e}function Q(t,n){var e=t[0]-n[0],i=t[1]-n[1];return e*e+i*i}function T(t,n,e){var i=n[0],r=n[1],a=e[0]-i,h=e[1]-r;if(0!==a||0!==h){var o=((t[0]-i)*a+(t[1]-r)*h)/(a*a+h*h);o>1?(i=e[0],r=e[1]):o>0&&(i+=a*o,r+=h*o)}return(a=t[0]-i)*a+(h=t[1]-r)*h}function U(t,n,e,i,r,a,h,o){var s,l,u,c,m=e-t,f=i-n,x=h-r,p=o-a,d=t-r,g=n-a,M=m*m+f*f,v=m*x+f*p,X=x*x+p*p,Y=m*d+f*g,_=x*d+p*g,B=M*X-v*v,b=B,w=B;0===B?(l=0,b=1,c=_,w=X):(c=M*_-v*Y,(l=v*_-X*Y)<0?(l=0,c=_,w=X):l>b&&(l=b,c=_+v,w=X)),c<0?(c=0,-Y<0?l=0:-Y>M?l=b:(l=-Y,b=M)):c>w&&(c=w,-Y+v<0?l=0:-Y+v>M?l=b:(l=-Y+v,b=M));var S=(1-(u=0===c?0:c/w))*r+u*h-((1-(s=0===l?0:l/b))*t+s*e),E=(1-u)*a+u*o-((1-s)*n+s*i);return S*S+E*E}function V(t,n){return t[0]===n[0]?t[1]-n[1]:t[0]-n[0]}exports.concaveman=J,exports.default=J;
//# sourceMappingURL=index.cjs.map
